(window.webpackJsonp=window.webpackJsonp||[]).push([[31,11],{"03bQ":function(e,t,a){"use strict";a.r(t);var n=a("XGcs"),i=a("n9eR");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);var r=a("KHd+"),s=Object(r.a)(i.default,n.a,n.b,!1,null,null,null);t.default=s.exports},"KHd+":function(e,t,a){"use strict";function n(e,t,a,n,i,o,r,s){var l,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=a,d._compiled=!0),n&&(d.functional=!0),o&&(d._scopeId="data-v-"+o),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},d._ssrRegister=l):i&&(l=s?function(){i.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(d.functional){d._injectStyles=l;var u=d.render;d.render=function(e,t){return l.call(t),u(e,t)}}else{var c=d.beforeCreate;d.beforeCreate=c?[].concat(c,l):[l]}return{exports:e,options:d}}a.d(t,"a",(function(){return n}))},LAbl:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"table-cont-add-box"},[t("p",{on:{click:this.tableContAddClick}},[t("span",{staticClass:"iconfont iconicon_add icon-add"}),this._v(" "),t("span",[this._v(this._s(this.$attrs.cont))])])])},i=[]},XGcs:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-rol-box"},[a("div",{staticClass:"user-rol-table"},[a("p",{staticClass:"user-rol-table__pay"},[e._v("付费用户组")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.upgradeData,"row-class-name":e.tableRowClassName},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",selectable:e.checkSelectable}}),e._v(" "),a("el-table-column",{attrs:{label:"级别","min-width":"20"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.$index+1))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"级别名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"显示组名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:7===t.row.id,"active-color":"#336699","inactive-color":"#bbbbbb"},model:{value:t.row.isDisplay,callback:function(a){e.$set(t.row,"isDisplay",a)},expression:"scope.row.isDisplay"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"medium"},on:{click:function(a){return e.extension(t.row.id)}}},[e._v("邀请")]),e._v(" "),1!==t.row.id?a("el-button",{attrs:{disabled:e.addStatus&&e.tableData.length-1===t.$index,type:"text"},on:{click:function(a){return e.$router.push({path:"/admin/rol-permission",query:{type:"isPaid",id:t.row.id,name:t.row.name}})}}},[e._v("设置")]):e._e(),e._v(" "),a("el-popover",{attrs:{width:"100",placement:"top"},model:{value:t.row.visible,callback:function(a){e.$set(t.row,"visible",a)},expression:"scope.row.visible"}},[a("p",[e._v("删除后，付费用户组中的用户将被移入默认分组或其他付费分组")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"10px 0 0 0"}},[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.cancelClick(t)}}},[e._v("\n                取消\n              ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.singleDelete(t.$index,t.row.id,"pay")}}},[e._v("确定")])],1),e._v(" "),1!==t.row.id&&6!==t.row.id&&7!==t.row.id&&10!==t.row.id&&1!==t.row.default?a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")]):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"50",label:"级别顺序"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"user-rol-table-box"},[t.$index!==e.upgradeData.length-1?a("span",{class:e.groupEdit?"user-rol-table__frame":"",on:{click:function(a){return e.dropOperation(t)}}},[a("i",{staticClass:"iconfont icon-xiangxiaicon table-icon"})]):e._e(),e._v(" "),0!==t.$index?a("span",{class:t.$index===e.upgradeData.length-1?e.groupEdit?"user-rol-table__right user-rol-table__frame":"user-rol-table__rights":e.groupEdit?"user-rol-table__frame":"",on:{click:function(a){return e.riseOperation(t)}}},[a("i",{staticClass:"iconfont icon-xiangshang table-icon"})]):e._e()])]}}])})],1),e._v(" "),e.upgradeData.length<5?a("TableContAdd",{attrs:{cont:"新增"},on:{tableContAddClick:e.upgradeList}}):e._e()],1),e._v(" "),a("Card",{staticClass:"footer-btn"},[a("el-button",{attrs:{type:"primary",loading:e.paidLoading,size:"medium"},on:{click:e.paidNewbtn}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{size:"medium",loading:e.delpaidLoading,disabled:e.deleteStatus},on:{click:e.deleteClick}},[e._v("删除")])],1),e._v(" "),a("div",{staticClass:"user-rol-table"},[a("p",{staticClass:"user-rol-table__pay"},[e._v("免费用户组")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",selectable:e.checkSelectable}}),e._v(" "),a("el-table-column",{attrs:{label:"级别名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{maxlength:"20"},model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"显示组名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:7===t.row.id,"active-color":"#336699","inactive-color":"#bbbbbb"},model:{value:t.row.isDisplay,callback:function(a){e.$set(t.row,"isDisplay",a)},expression:"scope.row.isDisplay"}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"medium"},on:{click:function(a){return e.extension(t.row.id)}}},[e._v("邀请")]),e._v(" "),1!==t.row.id?a("el-button",{attrs:{disabled:e.addStatus&&e.tableData.length-1===t.$index,type:"text"},on:{click:function(a){return e.$router.push({path:"/admin/rol-permission",query:{type:"normal",id:t.row.id,name:t.row.name}})}}},[e._v("设置")]):e._e(),e._v(" "),a("el-popover",{ref:"popover-"+t.$index,attrs:{width:"100",placement:"top"}},[a("p",[e._v("确定删除该项吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"10px 0 0 0"}},[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t._self.$refs["popover-"+t.$index].doClose()}}},[e._v("\n                取消\n              ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.singleDelete(t.$index,t.row.id,"normal"),t._self.$refs["popover-"+t.$index].doClose()}}},[e._v("确定")])],1),e._v(" "),1!==t.row.id&&6!==t.row.id&&7!==t.row.id&&10!==t.row.id&&1!==t.row.default&&8!==t.row.id?a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")]):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"115"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!=t.row.id&&6!==t.row.id&&7!==t.row.id?a("el-radio",{attrs:{label:t.row.id},on:{change:function(a){return e.radioChange(t.row,t.$index)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("设为加入站点的默认级别")]):e._e()]}}])})],1),e._v(" "),a("TableContAdd",{attrs:{cont:"新增"},on:{tableContAddClick:e.addList}})],1),e._v(" "),a("Card",{staticClass:"footer-btn"},[a("el-button",{attrs:{type:"primary",loading:e.btnLoading,size:"medium"},on:{click:e.submitClick}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{size:"medium",loading:e.delLoading,disabled:e.deleteStatus},on:{click:e.deleteClick}},[e._v("删除")])],1)],1)},i=[]},hSRv:function(e,t,a){},kAKY:function(e,t,a){"use strict";a.r(t);var n=a("LAbl"),i=a("uHrf");for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);var r=a("KHd+"),s=Object(r.a)(i.default,n.a,n.b,!1,null,null,null);t.default=s.exports},mHKG:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{}},methods:{tableContAddClick:function(){this.$emit("tableContAddClick")}}}},mHlf:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a("m1cH")),i=s(a("4gYi")),o=s(a("pNQN")),r=s(a("kAKY"));function s(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{tableData:[],alternateLength:0,feeDataLength:0,radio:"",alternateRadio:"",radioName:"",radioIndex:"",deleteStatus:!0,multipleSelection:[],addStatus:!1,btnLoading:!1,paidLoading:!1,delLoading:!1,groupId:"",upgradeData:[],groupEdit:!1,counter:""}},methods:{handleSelectionChange:function(e){this.multipleSelection=e,this.multipleSelection.length>=1?this.deleteStatus=!1:this.deleteStatus=!0},radioChange:function(e,t){this.radioName=e.name,this.radioIndex=t,this.groupId=e.id},checkSelectable:function(e){switch(e.id){case 1:case 6:case 7:case 10:return!1;default:return!0}},addList:function(){this.alternateLength>=this.tableData.length&&this.tableData.push({name:"",type:"",color:"",icon:""}),this.addStatus=!0},upgradeList:function(){this.$router.push({path:"/admin/rol-permission",query:{type:"pay",groupFeeData:this.upgradeData}})},paidNewbtn:function(){this.paidLoading=!0,this.groupEdit=!1;var e=[];this.upgradeData.forEach((function(t,a){e.push({name:t.name,id:t.id,isDisplay:t.isDisplay,level:a+1,visible:!1}),t.level=a+1})),this.batchPatchGroup(e)},submitClick:function(){var e=this;if(this.btnLoading=!0,this.addStatus){for(var t={type:"groups",name:"",default:""},a=this.alternateLength;a<this.tableData.length;a++)t.name=this.tableData[a].name;this.radioIndex+1===this.tableData.length&&(t.default=1),this.postGroups(t)}else{var n=[];this.tableData.forEach((function(t){n.push({name:t.name,id:t.id,isDisplay:t.isDisplay,default:t.id==e.radio})})),this.batchPatchGroup(n)}},singleDelete:function(e,t,a){"normal"===a?e>this.alternateLength-1?(this.tableData.pop(),this.addStatus=!1):this.singleDeleteGroup(t):"pay"===a&&(this.upgradeData[e].visible=!1,e>this.upgradeData.length-1?this.upgradeData.pop():this.singleDeleteGroup(t))},deleteClick:function(){this.delLoading=!0;var e={id:[]};this.multipleSelection.forEach((function(t){e.id.push(t.id)})),this.batchDeleteGroup(e)},getGroups:function(){var e=this;this.appFetch({url:"groups_list_get_v3",method:"get",data:{}}).then((function(t){if(t.errors)e.$message.error(t.errors[0].code);else{if(0!==t.Code)return void e.$message.error(t.Message);var a=t.Data;e.tableData=[],e.upgradeData=[],a.forEach((function(t){1===t.isPaid?e.upgradeData.push(t):e.tableData.push(t)})),e.alternateLength=e.tableData.length,e.tableData.forEach((function(t){e.groupName=t.isDisplay,1==t.default&&(e.radio=t.id,e.alternateRadio=t.id)})),e.orderList()}})).catch((function(e){}))},postGroups:function(e){var t=this;this.appFetch({url:"groups_create_post_v3",method:"post",data:e}).then((function(e){if(t.btnLoading=!1,t.paidLoading=!1,e.errors)e.errors[0].detail?t.$message.error(e.errors[0].code+"\n"+e.errors[0].detail[0]):t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);t.$message({message:"提交成功！",type:"success"}),t.addStatus=!1,t.getGroups()}})).catch((function(e){}))},singleDeleteGroup:function(e){var t=this;this.appFetch({url:"groups_batchdelete_post_v3",method:"post",data:{ids:e}}).then((function(e){if(e.errors)t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);t.$message({message:"删除成功！",type:"success"}),t.getGroups()}})).catch((function(e){}))},batchDeleteGroup:function(e){var t=this,a=e.id.toString();this.appFetch({url:"groups_batchdelete_post_v3",method:"post",data:{ids:a}}).then((function(e){if(t.delLoading=!1,e.errors)t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);t.$message({message:"删除成功！",type:"success"}),t.getGroups()}})).catch((function(e){}))},batchPatchGroup:function(e){var t=this;this.appFetch({url:"groups_batchupdate_post_v3",method:"post",data:{data:e}}).then((function(e){if(t.btnLoading=!1,t.paidLoading=!1,e.errors)t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);t.$message({message:"提交成功！",type:"success"}),t.getGroups()}})).catch((function(e){}))},PermissionPurchaseAllowed:function(){this.appFetch({url:"groups",method:"PATCH",splice:"/"+this.groupId,data:{data:{attributes:{name:this.radioName,is_paid:0}}}}).then((function(e){})).catch((function(e){}))},extension:function(e){var t=this;this.appFetch({url:"invite_link_v3",method:"get",data:{groupId:e}}).then((function(e){if(e.errors)t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);var a=document.createElement("input");a.value=window.location.protocol+"//"+window.location.host+"/forum/partner-invite?inviteCode="+e.Data.code,a.id="copyInput",document.body.appendChild(a),a.select(),document.execCommand("Copy"),t.$message({message:"链接已复制到剪贴板",type:"success"}),setTimeout((function(){a.remove()}),100)}}))},riseOperation:function(e){var t=this;this.groupEdit=!0;var a=[].concat((0,n.default)(this.upgradeData)),i=[].concat((0,n.default)(this.upgradeData));i.splice(e.$index,1),i.splice(e.$index-1,0,a[e.$index]),this.counter=e.$index-1,setTimeout((function(){t.counter=""}),500),this.upgradeData=i},dropOperation:function(e){var t=this;this.groupEdit=!0;var a=[].concat((0,n.default)(this.upgradeData)),i=[].concat((0,n.default)(this.upgradeData));i.splice(e.$index,1),i.splice(e.$index+1,0,a[e.$index]),this.counter=e.$index+1,setTimeout((function(){t.counter=""}),500),this.upgradeData=i},tableRowClassName:function(e){e.row;return e.rowIndex===this.counter?"success-row":""},cancelClick:function(e){this.upgradeData[e.$index].visible=!1},orderList:function(){this.upgradeData.sort(this.soreoder("level"))},soreoder:function(e){return function(t,a){return t[e]-a[e]}}},created:function(){this.getGroups()},components:{Card:i.default,CardRow:o.default,TableContAdd:r.default}}},n9eR:function(e,t,a){"use strict";a.r(t);var n=a("u/uZ"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},"u/uZ":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a("QbLZ"));a("I1+7");var i=o(a("mHlf"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,n.default)({name:"user-rol-view"},i.default)},uHrf:function(e,t,a){"use strict";a.r(t);var n=a("yeSa"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t.default=i.a},yeSa:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a("QbLZ"));a("hSRv");var i=o(a("mHKG"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,n.default)({name:"table-cont-add-view"},i.default)}}]);